(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d0f2e"],{"69c8":function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{margin:"20px"}},[a("h1",[e._v("微信JSAPI支付")]),a("el-form",{ref:"dataForm",attrs:{"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"支付金额",prop:"totalFee"}},[a("el-input-number",{attrs:{placeholder:"请输入支付金额"},model:{value:e.payData.totalFee,callback:function(t){e.$set(e.payData,"totalFee",t)},expression:"payData.totalFee"}}),a("span",{staticStyle:{"margin-left":"20px",color:"red"}},[e._v("(单位：分)")])],1)],1),a("div",{staticStyle:{margin:"20px 100px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.getPay}},[e._v("立即支付")]),a("el-button",{attrs:{type:"primary"},on:{click:e.clearBack}},[e._v("返回")])],1)],1)},i=[],s=a("5530"),o=(a("b64b"),a("ac1f"),a("5319"),{name:"WechatJsapiPay",data:function(){return{payData:{productId:"xxxx-xxxx-xx-x",productName:"测试商品",totalFee:1,attach:""}}},methods:{getPay:function(){var e=this;this.payData=Object(s["a"])({},JSON.parse(window.sessionStorage.getItem("payData")));var t=Object(s["a"])(Object(s["a"])({},this.payData),{},{openId:"oA1uP6Q6ByzfrUpXr_N4dPuXmuQk"});this.$request({url:"/pay/wechat/getPayJsapi",method:"post",data:t}).then((function(t){var a=JSON.parse(t.data.payInfo);"undefined"===typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e.onBridgeReady(a),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e.onBridgeReady(a)),document.attachEvent("onWeixinJSBridgeReady",e.onBridgeReady(a))):e.onBridgeReady(a),e.wechatPayUpdateStatus(t.data.tradeId)}))},onBridgeReady:function(e){WeixinJSBridge.invoke("getBrandWCPayRequest",e,(function(e){"get_brand_wcpay_request:ok"==e.err_msg?(this.$message({type:"success",message:"支付成功!"}),this.clearBack()):this.$message({type:"error",message:"支付失败!"})}))},wechatPayUpdateStatus:function(e){var t=this,a={tradeId:e};n=setInterval((function(){t.$request({url:"/pay/wechat/getPayResult",method:"get",params:a}).then((function(e){1===e.data.tradeStatus&&(t.$message({type:"success",message:"您已支付成功!",duration:5e3,showClose:!0}),t.clearBack())}))}),2e3)},clearBack:function(){clearInterval(n),this.$router.replace("/demo/trade")}}}),d=o,c=a("2877"),u=Object(c["a"])(d,r,i,!1,null,null,null);t["default"]=u.exports}}]);