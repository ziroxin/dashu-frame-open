(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2700ec20"],{"1c59":function(e,t,i){"use strict";var n=i("6d61"),r=i("6566");n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"4fad":function(e,t,i){var n=i("d039"),r=i("861d"),s=i("c6b6"),a=i("d86b"),o=Object.isExtensible,l=n((function(){o(1)}));e.exports=l||a?function(e){return!!r(e)&&((!a||"ArrayBuffer"!=s(e))&&(!o||o(e)))}:o},5582:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-row",[i("el-col",{attrs:{span:9}},[i("div",{staticStyle:{"margin-bottom":"10px"}},[i("el-button",{on:{click:e.toggleTableOprate}},[e._v("全部"+e._s(e.isExpand?"收起":"展开"))])],1),i("div",{staticClass:"grid-content bg-purple"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"permissionTable",staticStyle:{width:"96%"},attrs:{"default-expand-all":e.isExpand,height:this.$windowHeight-200,border:"",data:e.tableData,"row-key":"permissionId","highlight-current-row":"","tree-props":{children:"children"}}},[i("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["0"===n.permissionType?i("el-tag",{attrs:{"disable-transitions":"",size:"mini"}},[e._v("路由")]):e._e(),"1"===n.permissionType?i("el-tag",{attrs:{"disable-transitions":"",type:"warning",size:"mini"}},[e._v("按钮")]):e._e(),"3"===n.permissionType?i("el-tag",{attrs:{"disable-transitions":"",type:"success",size:"mini"}},[e._v("其他")]):e._e(),e._v(" "+e._s(n.permissionTitle)+e._s(n.permissionRouter?"("+n.permissionRouter+")":"")+" ")]}}])}),i("el-table-column",{attrs:{label:"操作",width:"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.setMyApi(n.permissionId)}}},[e._v(" 设置API ")])]}}])})],1)],1)]),i("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading2,expression:"listLoading2"}],staticStyle:{"padding-left":"10px","border-left":"1px solid #dedede"},attrs:{span:15}},[i("div",{staticClass:"grid-content bg-purple-light"},[i("div",{staticStyle:{"margin-bottom":"10px"}},[i("el-button",{attrs:{type:"primary",disabled:e.isSaveBtn,icon:"el-icon-check",size:"small"},on:{click:function(t){return e.savePermissionApi()}}},[e._v("保存关联API ")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openGroupDialog()}}},[e._v("设置分组")]),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.scanApi()}}},[e._v("自动扫描API（增量）")]),i("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.clearApi()}}},[e._v("清除无效API")])],1),i("div",{style:"height:"+(this.$windowHeight-200)+"px;overflow-y: auto;"},[i("el-collapse",{staticStyle:{"padding-top":"5px"},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.tableData2,(function(t){return i("el-collapse-item",{key:t.apiGroupId,attrs:{name:t.apiGroupId}},[i("template",{slot:"title"},[i("div",{staticClass:"collapse-title"},[e._v(" 分组："+e._s(t.groupName)+" "),"no_group_api"!==t.apiGroupId?i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(i){return i.stopPropagation(),e.deleteGroup(t.apiGroupId)}}}):e._e()],1)]),i("el-checkbox-group",{staticStyle:{"line-height":"50px"},model:{value:e.selectPermissionApiList,callback:function(t){e.selectPermissionApiList=t},expression:"selectPermissionApiList"}},[e._l(t.apiClass,(function(t){return[i("el-divider",{key:t.className},[e._v(e._s(t.className))]),e._l(t.apiList,(function(t){return[i("el-tooltip",{key:"tip"+t.apiId,attrs:{placement:"left"}},[i("div",{key:"tipcontent"+t.apiId,staticStyle:{"line-height":"30px"},attrs:{slot:"content"},slot:"content"},[e._v(" 请求地址："+e._s(t.apiRequestUrl)+" "),i("br"),e._v("请求方式："+e._s(t.apiRequestMethod)+" "),i("br"),e._v("描述："+e._s(t.apiDescription)+" ")]),i("el-checkbox",{key:t.apiId,staticStyle:{"margin-left":"0px!important",height:"50px"},attrs:{label:t.apiId,border:""}},[e._v(" "+e._s(t.apiName)),i("br"),e._v(e._s(t.apiRequestUrl)+" ")])],1)]}))]}))],2)],2)})),1)],1)])])],1),i("el-dialog",{attrs:{visible:e.groupDialogShow},on:{"update:visible":function(t){e.groupDialogShow=t}}},[i("el-form",{ref:"groupDataForm",staticStyle:{width:"500px","margin-left":"50px"},attrs:{model:e.temp,rules:e.rules,"label-position":"right","label-width":"100px"}},[i("el-form-item",{attrs:{label:""}},[i("el-radio",{attrs:{label:"0"},on:{change:function(t){e.isNewGroup="0",e.temp={}}},model:{value:e.isNewGroup,callback:function(t){e.isNewGroup=t},expression:"isNewGroup"}},[e._v("创建新分组")]),i("el-radio",{attrs:{label:"1"},on:{change:function(t){e.isNewGroup="1"}},model:{value:e.isNewGroup,callback:function(t){e.isNewGroup=t},expression:"isNewGroup"}},[e._v("加入已有分组")])],1),"0"===e.isNewGroup?i("el-form-item",{attrs:{label:"分组名称：",prop:"groupName"}},[i("el-input",{attrs:{placeholder:"请输入分组名称"},model:{value:e.temp.groupName,callback:function(t){e.$set(e.temp,"groupName",t)},expression:"temp.groupName"}})],1):i("el-form-item",{attrs:{label:"选择分组：",prop:"apiGroupId"}},[i("el-select",{attrs:{placeholder:"请选择分组"},on:{change:e.groupSelectChange},model:{value:e.temp.apiGroupId,callback:function(t){e.$set(e.temp,"apiGroupId",t)},expression:"temp.apiGroupId"}},e._l(e.groupList,(function(e){return i("el-option",{key:e.apiGroupId,attrs:{label:e.groupName,value:e.apiGroupId}})})),1)],1),"0"===e.isNewGroup?i("el-form-item",{attrs:{label:"分组顺序：",prop:"groupOrder"}},[i("el-input-number",{model:{value:e.temp.groupOrder,callback:function(t){e.$set(e.temp,"groupOrder",t)},expression:"temp.groupOrder"}})],1):e._e()],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.saveGroupInfo}},[e._v("保存")]),i("el-button",{on:{click:function(t){e.groupDialogShow=!1}}},[e._v("取消")])],1)],1)],1)},r=[],s=i("5530"),a=i("2909"),o=i("b85c"),l=i("c7eb"),u=i("1da1"),c=(i("d3b7"),i("159b"),i("14d9"),i("6062"),i("3ca3"),i("ddb0"),i("b775"));function p(){return Object(c["a"])({url:"/api/listGroupApi",method:"get"})}function d(){return Object(c["a"])({url:"/permission/tree/list",method:"get"})}function f(){return Object(c["a"])({url:"api/saveScanApi",method:"get"})}function g(){return Object(c["a"])({url:"api/clearApi",method:"get"})}function m(e){return Object(c["a"])({url:"permission/api/getApiListByPermissionId",method:"get",params:e})}function v(e){return Object(c["a"])({url:"permission/api/savePermissionApi",method:"post",data:e})}function h(e){return Object(c["a"])({url:"api/group/add",method:"post",data:e})}function b(e){return Object(c["a"])({url:"api/group/delete",method:"post",params:e})}var x={data:function(){return{isExpand:!0,currentPermissionId:"",selectPermissionApiList:[],activeNames:[],tableData:[],tableData2:[],listLoading:!0,listLoading2:!0,isSaveBtn:!0,groupDialogShow:!1,isNewGroup:"0",temp:{},rules:{groupName:[{required:!0,message:"分组名称必填",trigger:"blur"}],groupOrder:[{required:!0,message:"分组顺序必填"}]},groupList:[]}},created:function(){this.getPermissionTreeList(),this.getApiList()},methods:{toggleTableOprate:function(){this.isExpand?this.isExpand=!1:this.isExpand=!0,this.toggleRowExpansionAll(this.tableData,this.isExpand)},toggleRowExpansionAll:function(e,t){var i=this;e.forEach((function(e){i.$refs.permissionTable.toggleRowExpansion(e,t),void 0!==e.children&&null!==e.children&&i.toggleRowExpansionAll(e.children,t)}))},getPermissionTreeList:function(){var e=this;return Object(u["a"])(Object(l["a"])().mark((function t(){var i,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,d();case 3:i=t.sent,n=i.data,e.tableData=n,e.listLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},getApiList:function(){var e=this;return Object(u["a"])(Object(l["a"])().mark((function t(){var i,n,r,s,a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading2=!0,t.next=3,p();case 3:i=t.sent,n=i.data,e.activeNames=[],r=Object(o["a"])(n);try{for(r.s();!(s=r.n()).done;)a=s.value,e.activeNames.push(a.apiGroupId)}catch(l){r.e(l)}finally{r.f()}e.tableData2=n,e.listLoading2=!1;case 10:case"end":return t.stop()}}),t)})))()},scanApi:function(){var e=this;return Object(u["a"])(Object(l["a"])().mark((function t(){var i,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading2=!0,t.next=3,f();case 3:i=t.sent,n=i.code,"200"===n&&e.$notify({title:"扫描成功",message:"扫描所有api已完成，并存入数据库中",type:"success"}),e.listLoading2=!0,e.getApiList();case 8:case"end":return t.stop()}}),t)})))()},clearApi:function(){var e=this;this.$confirm("确定要清除无效的Api吗?","提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.listLoading2=!0,g().then((function(t){var i=t.code;"200"===i?(e.$message({type:"success",message:"清除无效的API成功！"}),e.getApiList()):e.$message({type:"error",message:"操作失败！"}),e.listLoading2=!1}))}))},setMyApi:function(e){var t=this;this.listLoading2=!0,m({permissionId:e}).then((function(i){var n=i.data;t.selectPermissionApiList=n?Object(a["a"])(new Set(n)):[],t.currentPermissionId=e,t.isSaveBtn=!1,t.listLoading2=!1}))},savePermissionApi:function(){var e=this;this.selectPermissionApiList.length<=0?this.$message({type:"error",message:"请至少选择一个API才能保存"}):(this.listLoading2=!0,v({permissionId:this.currentPermissionId,apiIds:this.selectPermissionApiList}).then((function(t){var i=t.code;"200"===i&&(e.$notify({title:"保存成功",message:"保存关联API成功！",type:"success"}),e.listLoading2=!1)})))},openGroupDialog:function(){var e=this;this.selectPermissionApiList.length<=0?this.$message({message:"至少选择一个API接口！",type:"error"}):(Object(c["a"])({url:"/api/group/list",method:"get"}).then((function(t){e.groupList=t.data})),this.groupDialogShow=!0)},groupSelectChange:function(e){var t=this;this.groupList.forEach((function(i){i.apiGroupId===e&&(t.temp.groupOrder=i.groupOrder,t.temp.groupName=i.groupName)}))},saveGroupInfo:function(){var e=this;"1"!==this.isNewGroup||void 0!==this.temp.apiGroupId?this.$refs.groupDataForm.validate((function(t){if(t){var i=Object(s["a"])({},e.temp);i.apiIds=e.selectPermissionApiList,h(i).then((function(t){e.groupDialogShow=!1,e.$notify({title:"保存成功",message:"分组信息保存成功！",type:"success"}),e.getApiList()}))}})):this.$message({type:"error",message:"请选择分组"})},deleteGroup:function(e){var t=this;this.$confirm("确定要删除该分组吗?","提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){b({apiGroupId:e}).then((function(e){var i=e.code;"200"===i&&(t.$notify({title:"删除成功",message:"删除API分组成功！",type:"success"}),t.getApiList())}))}))}}},y=x,w=(i("8f62"),i("2877")),_=Object(w["a"])(y,n,r,!1,null,null,null);t["default"]=_.exports},6062:function(e,t,i){i("1c59")},6566:function(e,t,i){"use strict";var n=i("7c73"),r=i("edd0"),s=i("6964"),a=i("0366"),o=i("19aa"),l=i("7234"),u=i("2266"),c=i("c6d2"),p=i("4754"),d=i("2626"),f=i("83ab"),g=i("f183").fastKey,m=i("69f3"),v=m.set,h=m.getterFor;e.exports={getConstructor:function(e,t,i,c){var p=e((function(e,r){o(e,d),v(e,{type:t,index:n(null),first:void 0,last:void 0,size:0}),f||(e.size=0),l(r)||u(r,e[c],{that:e,AS_ENTRIES:i})})),d=p.prototype,m=h(t),b=function(e,t,i){var n,r,s=m(e),a=x(e,t);return a?a.value=i:(s.last=a={index:r=g(t,!0),key:t,value:i,previous:n=s.last,next:void 0,removed:!1},s.first||(s.first=a),n&&(n.next=a),f?s.size++:e.size++,"F"!==r&&(s.index[r]=a)),e},x=function(e,t){var i,n=m(e),r=g(t);if("F"!==r)return n.index[r];for(i=n.first;i;i=i.next)if(i.key==t)return i};return s(d,{clear:function(){var e=this,t=m(e),i=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete i[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:e.size=0},delete:function(e){var t=this,i=m(t),n=x(t,e);if(n){var r=n.next,s=n.previous;delete i.index[n.index],n.removed=!0,s&&(s.next=r),r&&(r.previous=s),i.first==n&&(i.first=r),i.last==n&&(i.last=s),f?i.size--:t.size--}return!!n},forEach:function(e){var t,i=m(this),n=a(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:i.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!x(this,e)}}),s(d,i?{get:function(e){var t=x(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),f&&r(d,"size",{configurable:!0,get:function(){return m(this).size}}),p},setStrong:function(e,t,i){var n=t+" Iterator",r=h(t),s=h(n);c(e,t,(function(e,t){v(this,{type:n,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=s(this),t=e.kind,i=e.last;while(i&&i.removed)i=i.previous;return e.target&&(e.last=i=i?i.next:e.state.first)?p("keys"==t?i.key:"values"==t?i.value:[i.key,i.value],!1):(e.target=void 0,p(void 0,!0))}),i?"entries":"values",!i,!0),d(t)}}},6964:function(e,t,i){var n=i("cb2d");e.exports=function(e,t,i){for(var r in t)n(e,r,t[r],i);return e}},"6d61":function(e,t,i){"use strict";var n=i("23e7"),r=i("da84"),s=i("e330"),a=i("94ca"),o=i("cb2d"),l=i("f183"),u=i("2266"),c=i("19aa"),p=i("1626"),d=i("7234"),f=i("861d"),g=i("d039"),m=i("1c7e"),v=i("d44e"),h=i("7156");e.exports=function(e,t,i){var b=-1!==e.indexOf("Map"),x=-1!==e.indexOf("Weak"),y=b?"set":"add",w=r[e],_=w&&w.prototype,k=w,A={},I=function(e){var t=s(_[e]);o(_,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(x&&!f(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return x&&!f(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(x&&!f(e))&&t(this,0===e?0:e)}:function(e,i){return t(this,0===e?0:e,i),this})},O=a(e,!p(w)||!(x||_.forEach&&!g((function(){(new w).entries().next()}))));if(O)k=i.getConstructor(t,e,b,y),l.enable();else if(a(e,!0)){var L=new k,N=L[y](x?{}:-0,1)!=L,G=g((function(){L.has(1)})),S=m((function(e){new w(e)})),P=!x&&g((function(){var e=new w,t=5;while(t--)e[y](t,t);return!e.has(-0)}));S||(k=t((function(e,t){c(e,_);var i=h(new w,e,k);return d(t)||u(t,i[y],{that:i,AS_ENTRIES:b}),i})),k.prototype=_,_.constructor=k),(G||P)&&(I("delete"),I("has"),b&&I("get")),(P||N)&&I(y),x&&_.clear&&delete _.clear}return A[e]=k,n({global:!0,constructor:!0,forced:k!=w},A),v(k,e),x||i.setStrong(k,e,b),k}},"8f62":function(e,t,i){"use strict";i("a9fd")},a9fd:function(e,t,i){},bb2f:function(e,t,i){var n=i("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d86b:function(e,t,i){var n=i("d039");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},f183:function(e,t,i){var n=i("23e7"),r=i("e330"),s=i("d012"),a=i("861d"),o=i("1a2d"),l=i("9bf2").f,u=i("241c"),c=i("057f"),p=i("4fad"),d=i("90e3"),f=i("bb2f"),g=!1,m=d("meta"),v=0,h=function(e){l(e,m,{value:{objectID:"O"+v++,weakData:{}}})},b=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,m)){if(!p(e))return"F";if(!t)return"E";h(e)}return e[m].objectID},x=function(e,t){if(!o(e,m)){if(!p(e))return!0;if(!t)return!1;h(e)}return e[m].weakData},y=function(e){return f&&g&&p(e)&&!o(e,m)&&h(e),e},w=function(){_.enable=function(){},g=!0;var e=u.f,t=r([].splice),i={};i[m]=1,e(i).length&&(u.f=function(i){for(var n=e(i),r=0,s=n.length;r<s;r++)if(n[r]===m){t(n,r,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},_=e.exports={enable:w,fastKey:b,getWeakData:x,onFreeze:y};s[m]=!0}}]);