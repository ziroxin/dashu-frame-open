(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10a9ceec"],{"21a6":function(e,t,a){(function(a){var s,n,i;(function(a,o){n=[],s=o,i="function"===typeof s?s.apply(t,n):s,void 0===i||(e.exports=i)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function s(e,t,a){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){l(s.response,t,a)},s.onerror=function(){console.error("could not download file")},s.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,t,a){var r=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?s(e,t,a):i(l,l.target="_blank")):(l.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,o){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),a);else if(n(e))s(e,a,o);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){i(r)}))}}:function(e,t,a,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return s(e,t,a);var i="application/octet-stream"===e.type,l=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&l||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var d=o.URL||o.webkitURL,m=d.createObjectURL(e);n?n.location=m:location.href=m,n=null,setTimeout((function(){d.revokeObjectURL(m)}),4e4)}});o.saveAs=l.saveAs=l,e.exports=l}))}).call(this,a("c8ba"))},"2fa5":function(e,t,a){},"8a60":function(e,t,a){"use strict";var s=a("c7eb"),n=a("1da1"),i=(a("b64b"),a("cee4")),o=a("5c96"),r=a("21a6"),l=a("5f87"),c={401:"认证失败，无法访问系统资源",403:"当前操作没有权限",404:"访问资源不存在",default:"系统未知错误，请反馈给管理员"},u=a("b893"),d="/dashuserver";t["a"]={zip:function(e,t){var a=this,s=o["Loading"].service({text:"正在下载数据，请稍候",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"});Object(i["a"])({method:"get",url:d+e,responseType:"blob",headers:{UserJwtToken:Object(l["a"])()}}).then((function(e){var n=Object(u["a"])(e.data);if(n){var i=new Blob([e.data],{type:"application/zip"});a.saveAs(i,t),s.close()}else a.printErrMsg(e.data),s.close()}))},download:function(e,t,a){var c=o["Loading"].service({text:"正在下载数据，请稍候",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"});Object(i["a"])({method:"get",url:d+e,params:t,headers:{UserJwtToken:Object(l["a"])()}}).then(function(){var e=Object(n["a"])(Object(s["a"])().mark((function e(t){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:"200"===t.data.code?(Object(r["saveAs"])(d+t.data.data,a),c.close()):o["Message"].error(t.data.message);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),o["Message"].error("下载文件出现错误，请重试！"),c.close()}))},saveAs:function(e,t,a){Object(r["saveAs"])(e,t,a)},printErrMsg:function(e){return Object(n["a"])(Object(s["a"])().mark((function t(){var a,n,i;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.text();case 2:a=t.sent,n=JSON.parse(a),i=c[n.code]||n.msg||c["default"],o["Message"].error(i);case 6:case"end":return t.stop()}}),t)})))()}}},a8ae:function(e,t,a){"use strict";a.r(t);a("14d9");var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{margin:"15px 0px 25px 0px"}},[t("el-input",{staticClass:"filter-item",staticStyle:{width:"240px","margin-right":"10px"},attrs:{size:"small",placeholder:"请输入消息标题查询"},model:{value:e.searchData.msgTitle,callback:function(t){e.$set(e.searchData,"msgTitle",t)},expression:"searchData.msgTitle"}}),t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.searchBtnHandle}},[e._v("查询 ")]),t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"info",size:"small",icon:"el-icon-refresh"},on:{click:e.resetTableList}},[e._v("重置 ")]),t("div",{staticStyle:{float:"right"}},["1"!==e.msgStatus?t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",size:"small",icon:"el-icon-check"},on:{click:e.markAllRead}},[e._v("全部标记已读 ")]):e._e(),t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(t){return e.deleteByIds(null)}}},[e._v("批量删除 ")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"dataTable",attrs:{data:e.tableData,stripe:"","show-header":!1},on:{"selection-change":e.handleTableSelectChange}},[t("el-table-column",{attrs:{type:"selection",width:"50",align:"center","header-align":"center"}}),t("el-table-column",{attrs:{label:"消息标题",prop:"msgTitle","max-width":"50%"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:{unread:"0"===a.row.msgStatus}},[e._v(" "+e._s(a.row.msgTitle)+" "),a.row.msgRouter?[0===a.row.msgRouter.indexOf("http")?t("el-link",{staticStyle:{"margin-left":"10px"},attrs:{target:"_blank",underline:!1,type:"primary",href:a.row.msgRouter},on:{click:function(t){return e.$router.push(a.row.msgRouter)}}},[e._v("打开 ")]):t("el-link",{staticStyle:{"margin-left":"10px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){return e.$router.push(a.row.msgRouter)}}},[e._v("打开 ")])]:e._e()],2)]}}])}),t("el-table-column",{attrs:{label:"消息创建时间",prop:"createTime",width:"150",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.openView(a.row)}}},[e._v("查看详情 ")]),t("el-button",{staticStyle:{color:"#ff6d6d"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteByIds(a.row)}}},[e._v("删除 ")])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center","margin-top":"10px"},attrs:{layout:"total,prev,pager,next,sizes,jumper","page-size":e.pager.limit,"current-page":e.pager.page,total:e.pager.totalCount},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),t("el-dialog",{key:"myDialog"+e.dialogIndex,attrs:{title:e.titleMap[e.dialogType],"close-on-click-modal":"view"===e.dialogType,visible:e.dialogFormVisible,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.resetTemp}},[t("el-form",{ref:"dataForm",attrs:{model:e.temp,"label-position":"right","label-width":"60px",disabled:"view"===e.dialogType}},[t("el-form-item",{attrs:{label:"标题：",prop:"msgTitle"}},[t("div",[e._v(e._s(e.temp.msgTitle))])]),t("el-form-item",{attrs:{label:"内容：",prop:"msgContent"}},[t("div",[e._v(e._s(e.temp.msgContent))])]),e.temp.msgRouter?[t("el-divider"),t("el-form-item",{attrs:{label:"链接：",prop:"msgRouter"}},[t("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(t){return e.$router.push(e.temp.msgRouter)}}},[e._v("点击进入页面 ")])],1)]:e._e()],2),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["view"!==e.dialogType?t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保存")]):e._e(),t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)},n=[],i=a("5530"),o=(a("e9c4"),a("d81d"),a("6724")),r=a("b775"),l=a("8a60"),c={name:"MessageList",props:["msgStatus"],directives:{waves:o["a"]},data:function(){return{pager:{page:1,limit:10,totalCount:0},tableData:[],searchData:{msgStatus:this.msgStatus},tableSelectRows:[],titleMap:{add:"添加消息中心",update:"修改消息中心",view:"查看详情"},dialogType:"",dialogFormVisible:!1,temp:{},isLoading:!1,dialogIndex:0}},created:function(){this.loadTableList(),this.resetTemp()},methods:{searchBtnHandle:function(){this.pager.page=1,this.loadTableList()},resetTableList:function(){this.pager.page=1,this.searchData={msgStatus:this.msgStatus},this.loadTableList()},loadTableList:function(){var e=this;this.$emit("refresh"),this.isLoading=!0;var t=Object(i["a"])(Object(i["a"])({},this.pager),{},{params:JSON.stringify(this.searchData)});Object(r["a"])({url:"/message/zMessage/list",method:"get",params:t}).then((function(t){var a=t.data;e.pager.totalCount=a.total,e.tableData=a.records,e.isLoading=!1}))},handleTableSelectChange:function(e){this.tableSelectRows=e},handleCurrentChange:function(e){this.pager.page=e,this.loadTableList()},handleSizeChange:function(e){this.pager.limit=e,this.loadTableList()},resetTemp:function(){this.temp={orderIndex:0},this.dialogIndex++},openAdd:function(){var e=this;this.resetTemp(),this.dialogFormVisible=!0,this.dialogType="add",this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},openUpdate:function(e){var t=this;e&&(this.$refs.dataTable.clearSelection(),this.$refs.dataTable.toggleRowSelection(e,!0)),this.tableSelectRows.length<=0?this.$message({message:"请选择一条数据修改！",type:"warning"}):this.tableSelectRows.length>1?this.$message({message:"修改时，只允许选择一条数据！",type:"warning"}):(this.temp=Object.assign({},this.tableSelectRows[0]),this.dialogType="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()})))},openView:function(e){var t=this;if("0"===e.msgStatus){var a={msgId:e.msgId,msgStatus:e.msgStatus};this.$request({url:"/message/zMessage/read",method:"get",params:a}).then((function(e){t.loadTableList()}))}this.temp=Object.assign({},e),this.dialogType="view",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},saveData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=Object(i["a"])({},e.temp);"update"===e.dialogType?Object(r["a"])({url:"/message/zMessage/update",method:"post",data:a}).then((function(t){e.$message({type:"success",message:"修改成功！"}),e.loadTableList(),e.dialogFormVisible=!1})):Object(r["a"])({url:"/message/zMessage/add",method:"post",data:a}).then((function(t){e.$message({type:"success",message:"添加成功！"}),e.loadTableList(),e.dialogFormVisible=!1}))}}))},deleteByIds:function(e){var t=this;e&&(this.$refs.dataTable.clearSelection(),this.$refs.dataTable.toggleRowSelection(e,!0)),this.tableSelectRows.length<=0?this.$message({message:"请选择一条数据删除！",type:"warning"}):this.$confirm("确定要删除吗?","删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.tableSelectRows.map((function(e){return e.msgId}));Object(r["a"])({url:"/message/zMessage/delete",method:"post",data:e}).then((function(e){t.$message({type:"success",message:"删除成功！"}),t.loadTableList()}))}))},markAllRead:function(){var e=this;this.$confirm("确定要全部标记为已读吗?","标记提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$request({url:"/message/zMessage/readAll",method:"get"}).then((function(t){e.loadTableList()}))}))},exportExcel:function(){var e={params:JSON.stringify(this.searchData)};l["a"].download("/message/zMessage/export/excel",e,"消息中心.xlsx")}}},u=c,d=(a("af26"),a("2877")),m=Object(d["a"])(u,s,n,!1,null,"a07bc0ca",null);t["default"]=m.exports},af26:function(e,t,a){"use strict";a("2fa5")},b75a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"全部("+e.count+")",name:"first"}},[t("message-list",{key:"first"+e.keyIndex,attrs:{"msg-status":e.msgStatus},on:{refresh:e.getCounts}})],1),t("el-tab-pane",{attrs:{label:"未读("+e.unreadCount+")",name:"second"}},[t("message-list",{key:"second"+e.keyIndex,attrs:{"msg-status":e.msgStatus},on:{refresh:e.getCounts}})],1),t("el-tab-pane",{attrs:{label:"已读("+(e.count-e.unreadCount)+")",name:"third"}},[t("message-list",{key:"third"+e.keyIndex,attrs:{"msg-status":e.msgStatus},on:{refresh:e.getCounts}})],1)],1)],1)},n=[],i=a("5530"),o=(a("b0c0"),a("a8ae")),r=a("2f62"),l={components:{MessageList:o["default"]},data:function(){return{activeName:"first",msgStatus:"",keyIndex:0}},computed:Object(i["a"])({},Object(r["c"])({count:function(e){return e.message.count},unreadCount:function(e){return e.message.unreadCount}})),mounted:function(){this.getCounts()},methods:{handleClick:function(e,t){this.msgStatus="third"===e.name?"1":"second"===e.name?"0":"",this.keyIndex++},getCounts:function(){this.$store.dispatch("message/refreshMessageCount")}}},c=l,u=a("2877"),d=Object(u["a"])(c,s,n,!1,null,null,null);t["default"]=d.exports}}]);